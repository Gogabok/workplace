
const nums = [
  {
    i: 0,
    color: "gold",
    colorHex: "#ffd434"
  },
  {
    i: 1,
    color: "red",
    colorHex: "#ED3F22"
  },
  {
    i: 2,
    color: "blue",
    colorHex: "#319CE9"
  },
  {
    i: 3,
    color: "red",
    colorHex: "#ED3F22"
  },
  {
    i: 4,
    color: "green",
    colorHex: "#39DC36"
  },
  {
    i: 5,
    color: "red",
    colorHex: "#ED3F22"
  },
  {
    i: 6,
    color: "green",
    colorHex: "#39DC36"
  },
  {
    i: 7,
    color: "red",
    colorHex: "#ED3F22"
  },
  {
    i: 8,
    color: "blue",
    colorHex: "#319CE9"
  },
  {
    i: 9,
    color: "red",
    colorHex: "#ED3F22"
  },
  {
    i: 10,
    color: "blue",
    colorHex: "#319CE9"
  },
  {
    i: 11,
    color: "red",
    colorHex: "#ED3F22"
  },
  {
    i: 12,
    color: "blue",
    colorHex: "#319CE9"
  },
  {
    i: 13,
    color: "red",
    colorHex: "#ED3F22"
  },
  {
    i: 14,
    color: "blue",
    colorHex: "#319CE9"
  },
  {
    i: 15,
    color: "red",
    colorHex: "#ED3F22"
  },
  {
    i: 16,
    color: "blue",
    colorHex: "#319CE9"
  },
  {
    i: 17,
    color: "red",
    colorHex: "#ED3F22"
  },
  {
    i: 18,
    color: "green",
    colorHex: "#39DC36"
  },
  {
    i: 19,
    color: "blue",
    colorHex: "#319CE9"
  },
  {
    i: 20,
    color: "green",
    colorHex: "#39DC36"
  },
  {
    i: 21,
    color: "red",
    colorHex: "#ED3F22"
  },
  {
    i: 22,
    color: "blue",
    colorHex: "#319CE9"
  },
  {
    i: 23,
    color: "red",
    colorHex: "#ED3F22"
  },
  {
    i: 24,
    color: "blue",
    colorHex: "#319CE9"
  },
  {
    i: 25,
    color: "red",
    colorHex: "#ED3F22"
  },
  {
    i: 26,
    color: "blue",
    colorHex: "#319CE9"
  },
  {
    i: 27,
    color: "red",
    colorHex: "#ED3F22"
  },
  {
    i: 28,
    color: "green",
    colorHex: "#39DC36"
  },
  {
    i: 29,
    color: "red",
    colorHex: "#ED3F22"
  },
  {
    i: 30,
    color: "green",
    colorHex: "#39DC36"
  },
  {
    i: 31,
    color: "red",
    colorHex: "#ED3F22"
  },
  {
    i: 32,
    color: "blue",
    colorHex: "#319CE9"
  },
  {
    i: 33,
    color: "red",
    colorHex: "#ED3F22"
  },
  {
    i: 34,
    color: "blue",
    colorHex: "#319CE9"
  },
  {
    i: 35,
    color: "red",
    colorHex: "#ED3F22"
  },
  {
    i: 36,
    color: "blue",
    colorHex: "#319CE9"
  },
  {
    i: 37,
    color: "red",
    colorHex: "#ED3F22"
  },
  {
    i: 38,
    color: "blue",
    colorHex: "#319CE9"
  },
  {
    i: 39,
    color: "red",
    colorHex: "#ED3F22"
  },
  {
    i: 40,
    color: "blue",
    colorHex: "#319CE9"
  },
  {
    i: 41,
    color: "red",
    colorHex: "#ED3F22"
  },
  {
    i: 42,
    color: "green",
    colorHex: "#39DC36"
  },
  {
    i: 43,
    color: "red",
    colorHex: "#ED3F22"
  },
  {
    i: 44,
    color: "green",
    colorHex: "#39DC36"
  },
  {
    i: 45,
    color: "red",
    colorHex: "#ED3F22"
  },
  {
    i: 46,
    color: "blue",
    colorHex: "#319CE9"
  },
  {
    i: 47,
    color: "red",
    colorHex: "#ED3F22"
  },
  {
    i: 48,
    color: "gold",
    colorHex: "#ffd434"
  },
  {
    i: 49,
    color: "red",
    colorHex: "#ED3F22"
  },
  {
    i: 50,
    color: "green",
    colorHex: "#39DC36"
  },
  {
    i: 51,
    color: "red",
    colorHex: "#ED3F22"
  },
  {
    i: 52,
    color: "blue",
    colorHex: "#319CE9"
  },
  {
    i: 53,
    color: "red",
    colorHex: "#ED3F22"
  },
  {
    i: 54,
    color: "blue",
    colorHex: "#319CE9"
  },
  {
    i: 55,
    color: "red",
    colorHex: "#ED3F22"
  },
  {
    i: 56,
    color: "green",
    colorHex: "#39DC36"
  },
  {
    i: 57,
    color: "red",
    colorHex: "#ED3F22"
  },
  {
    i: 58,
    color: "green",
    colorHex: "#39DC36"
  },
  {
    i: 59,
    color: "red",
    colorHex: "#ED3F22"
  },
  {
    i: 60,
    color: "blue",
    colorHex: "#319CE9"
  },
  {
    i: 61,
    color: "red",
    colorHex: "#ED3F22"
  },
  {
    i: 62,
    color: "blue",
    colorHex: "#319CE9"
  },
  {
    i: 63,
    color: "red",
    colorHex: "#ED3F22"
  },
  {
    i: 64,
    color: "blue",
    colorHex: "#319CE9"
  },
  {
    i: 65,
    color: "red",
    colorHex: "#ED3F22"
  },
  {
    i: 66,
    color: "green",
    colorHex: "#39DC36"
  },
  {
    i: 67,
    color: "red",
    colorHex: "#ED3F22"
  },
  {
    i: 68,
    color: "green",
    colorHex: "#39DC36"
  },
  {
    i: 69,
    color: "red",
    colorHex: "#ED3F22"
  },
  {
    i: 70,
    color: "blue",
    colorHex: "#319CE9"
  },
  {
    i: 71,
    color: "red",
    colorHex: "#ED3F22"
  },
]

const animationDuration = 7000
const timingBetweenRotating = 20000
const stepDeg = 360 / nums.length
const spinner = $('.colored-circle')
let transformation = 0



function startCounting () {
  $("#counter").counter("start");
  $(".currentText").toggle()
}
function starting () {
  $("#counterWrapper--text").text("Stop placing bets")
  $(".currentText").toggle()
  setTimeout(() => {
    let randElement = nums[Math.floor(Math.random() * (nums.length))];
    let transform = 360 - (randElement.i * stepDeg)
    transformation = transform
    let currentRotate = transformation + 720
    rotating(randElement, transformation, currentRotate)
    $("#counterWrapper--text").text("")
    console.log(transformation, randElement, currentRotate)
  }, 2000);
}

function rotating(randElement, transformation, currentRotate) {
  spinner.css("transition-duration", + animationDuration + "ms")
  spinner.css('transform', 'rotate(' + currentRotate + 'deg)');
  setTimeout(() => {
    fixing(randElement, transformation)
  }, animationDuration);
}

function fixing(randElement, transformation) {
  spinner.css("transition-duration", "0s")
  spinner.css('transform', 'rotate(' + transformation + 'deg)')
  $("<style>#counterWrapper--text, #counter { color: " + randElement.colorHex + " } .x50_circle__arr div { border-color:  transparent transparent" + randElement.colorHex + "; !important }</style>").appendTo("head")
  setTimeout(() => {
    $("#counterWrapper--text").text("Preparing next round")
    setTimeout(() => {
      startCounting()
    }, 1000);
  }, 1000);
}




$("#counter").counter({
  autoStart: false,      
  duration: timingBetweenRotating,          
  countFrom: 20,       
  countTo: 0,              
  runOnce: false,             
  placeholder: "",
  easing: "linear",
  format: '(,ddd).dd',
  onStart: function () { },
  onComplete: function () { 
    starting()
  }, 
  numberFormatter:
    function (number) {
      return (number.toFixed(1));
    }
});



$(document).ready(function () {
  $("#counter").hide()
  setTimeout(() => {
    startCounting()
  }, 1000);
});
